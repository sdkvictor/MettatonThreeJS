<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
		<title>My first three.js app</title>
		<link rel="stylesheet" href="css/main.css"> 
	</head>
	<body>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/2.1.2/TweenMax.min.js"></script>        
        <script src="js/mtl.js"></script>
        <script src="js/obj.js"></script>
		<script>
			const scene = new THREE.Scene();
			const camera = new THREE.PerspectiveCamera( 75, window.innerWidth / window.innerHeight, 0.1, 1000 );
            camera.position.z = 50;
            camera.position.x = 0;

            //scene.setClearColor('#')
			const renderer = new THREE.WebGLRenderer({antialias: true, alpha: true});
            renderer.setClearColor('#DFFDDD');
			renderer.setSize( window.innerWidth, window.innerHeight );
            
			document.body.appendChild( renderer.domElement );

            window.addEventListener('resize', () => {
                renderer.setSize(window.innerWidth, window.innerHeight);
                camera.aspect = window.innerWidth / window.innerHeight;

                camera.updateProjectMatrix();
            })
            

            //Add light
            var light = new THREE.PointLight(0xFFFFFF, 1.4, 1000);
            light.position.set(0,15,15);
            var light2 = new THREE.PointLight(0xFFFFFF, 1.4, 1000);
            light2.position.set(80,0,80);
            scene.add(light);
            scene.add(light2);

			/*
            const geometry = new THREE.BoxGeometry();
			const material = new THREE.MeshBasicMaterial( { color: 0x00ff00 } );
			const cube = new THREE.Mesh( geometry, material );
			scene.add( cube );

            */
            

            var stageObj;
            var mtlLoader = new THREE.MTLLoader();
            mtlLoader.load('assets/stage.mtl', function (materials) {
                materials.preload();
                var objLoader = new THREE.OBJLoader();
                objLoader.setMaterials(materials);
                objLoader.load('assets/stage.obj', function (object){
                    scene.add(object);
                    object.position.z -= 300;
                    object.position.y -= 80;
                    object.rotation.x = 1;
                });
            });

            // Circles
            const geometry = new THREE.CircleGeometry( 4, 32 );
            const material = new THREE.MeshBasicMaterial( { color: 0xFF0808 } );
            const ULCircle = new THREE.Mesh( geometry, material );
            const URCircle = ULCircle.clone();
            const LLCircle = ULCircle.clone();
            const LRCircle = ULCircle.clone();
            const UCCircle = ULCircle.clone();
            const material2 = new THREE.MeshBasicMaterial( { color: 0xC0C0C0 } );
            const CCircle = new THREE.Mesh( geometry, material2 );
            scene.add(ULCircle);
            scene.add(URCircle);
            scene.add(LLCircle);
            scene.add(LRCircle);
            scene.add(UCCircle);
            scene.add(CCircle);

            // Upper Left Circle
            ULCircle.position.x -= 13;
            ULCircle.position.y += 7;
            ULCircle.rotation.x = 1;
            ULCircle.rotation.y = 0.2;

            // Upper Right Circle
            URCircle.position.x += 13;
            URCircle.position.y += 7;
            URCircle.rotation.x = 1;
            URCircle.rotation.y -= 0.2;

            // Lower Left Circle
            LLCircle.position.x -= 10;
            LLCircle.position.y -= 5;
            LLCircle.rotation.x = 0.8;
            LLCircle.rotation.y = 0.2;

            // Lower Right Circle
            LRCircle.position.x += 10;
            LRCircle.position.y -= 5;
            LRCircle.rotation.x = 0.8;
            LRCircle.rotation.y -= 0.1;

            // Upper Center Circle
            UCCircle.position.set(4, 50, -125);
            UCCircle.scale.set(4,3,3);

            // Center Circle
            CCircle.position.set(4, 21, -120);
            CCircle.scale.set(4,2.7,3);
            var color = new THREE.Color(0xC0C0C0);


            mtlLoader.load('assets/meta.mtl', function (materials) {
                materials.preload();
                var objLoader = new THREE.OBJLoader();
                objLoader.setMaterials(materials);        
            objLoader.load('assets/meta.obj', function (object){
                    scene.add(object);
                    object.position.z -= 280;
                    object.position.y -= 50;
                    object.position.x += 5;
                    object.rotation.x = 1;

                });
            });

            // modelo de frisk es de eytamdorfman, https://www.tinkercad.com/things/9H55fVfQuBh-undertale-frisk
            mtlLoader.load('assets/Frisk.mtl', function (materials) {
                materials.preload();
                var objLoader = new THREE.OBJLoader();
                objLoader.setMaterials(materials);        
            objLoader.load('assets/Frisk.obj', function (object){
                    scene.add(object);
                    object.position.z -= 80;
                    object.position.y -= 20;
                    object.position.x -= 0;
                    object.rotation.y = 3.14159;
                    object.rotation.x = 0.8;
                    object.scale.x = 0.1;
                    object.scale.y = 0.1;
                    object.scale.z = 0.1;

                });
            });
			/*
            const animate = function () {
				requestAnimationFrame( animate );

				cube.rotation.x += 0.01;
				cube.rotation.y += 0.01;

				
			}; 
            
			animate();
            */

            var render = function() {
                requestAnimationFrame(render);
                //stageObj.rotation.z = .01;
                renderer.render( scene, camera );
            }

            render();
		</script>
	</body>
</html>